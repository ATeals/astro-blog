---
import { MDXWrapper } from '@/components/MDXWrapper';
import PostJsonLd from '@/components/PostJsonLd.astro';
import BlogPost from '@/layouts/BlogPost.astro';
import DefaultLayout from '@/layouts/DefaultLayout.astro';
import type { CollectionData } from '@/service/mdx';
import { PostBuilder } from '@/service/mdx';

export async function getStaticPaths() {
  const document = await PostBuilder.getAll();

  const post = [...document];

  return post.map((post) => ({
    params: { slug: post.slug },
    props: post
  }));
}

type Props = CollectionData;

const post = Astro.props;

const { prev, next } = await PostBuilder.getAdjacentType(post);

const { Content } = await post.render();
---

<DefaultLayout
  seo={{
    title: `${post.data.title}`,
    description: post.data.description,
    image: post.data.image
  }}
>
  <BlogPost next={next} post={post} prev={prev}>
    <MDXWrapper>
      <Content />
    </MDXWrapper>
  </BlogPost>
</DefaultLayout>
<PostJsonLd post={post} />
